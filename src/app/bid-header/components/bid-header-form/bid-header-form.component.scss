@use '@angular/material' as mat;

// ===============================
//  DESIGN TOKENS
// ===============================

$primary-color: #1976d2;
$primary-dark: #1565c0;
$primary-light: #42a5f5;
$accent-color: #2196f3;
$warn-color: #f44336;
$success-color: #4caf50;

$bg-main: #f3f6fb;
$bg-glass: rgba(255, 255, 255, 0.18);
$border-soft: rgba(255, 255, 255, 0.35);

$text-primary: #1f2933;
$text-secondary: #6b7280;
$text-muted: #9ca3af;

$radius-sm: 8px;
$radius-md: 12px;
$radius-lg: 18px;

$shadow-soft: 0 10px 30px rgba(15, 23, 42, 0.06);
$shadow-soft-strong: 0 18px 45px rgba(15, 23, 42, 0.14);

$spacing: 8px;

// ===============================
//  MIXINS
// ===============================

@mixin transition-all($duration: 0.22s) {
  transition: all $duration cubic-bezier(0.4, 0, 0.2, 1);
}

@mixin glass-panel {
  background: $bg-glass;
  backdrop-filter: blur(18px) saturate(1.3);
  -webkit-backdrop-filter: blur(18px) saturate(1.3);
  border-radius: $radius-lg;
  border: 1px solid $border-soft;
  box-shadow: $shadow-soft;
}

@mixin card-elevated {
  @include glass-panel;
  box-shadow: $shadow-soft-strong;
}

// ===============================
//  PAGE WRAPPER (optional, host)
// ===============================

:host {
  display: block;
  padding: $spacing * 3;
  background:
    radial-gradient(circle at top left, rgba(25, 118, 210, 0.08), transparent 55%),
    radial-gradient(circle at bottom right, rgba(66, 165, 245, 0.09), transparent 55%),
    $bg-main;

  // smooth scrolling inside this page
  scroll-behavior: smooth;
}

// ===============================
//  FORM CARD (OUTER CARD)
// ===============================

.form-card.glass-card {
  @include glass-panel;
  border-radius: $radius-lg;
  overflow: hidden;
  margin-bottom: $spacing * 3;
  animation: fadeInCard 0.4s ease-out;

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: $spacing * 2.5 $spacing * 3;
    background: linear-gradient(
      135deg,
      rgba($primary-color, 0.08),
      rgba($primary-light, 0.03)
    );
    border-bottom: 1px solid rgba(255, 255, 255, 0.6);

    .card-title-wrapper {
      display: flex;
      align-items: center;
      gap: $spacing * 1.5;

      .card-icon {
        color: $primary-color;
        font-size: 26px;
        width: 26px;
        height: 26px;
      }

      .card-title {
        font-size: 22px;
        font-weight: 600;
        color: $text-primary;
        letter-spacing: 0.02em;
      }
    }

    .go-list-btn {
      @include transition-all(0.18s);
      border-radius: $radius-sm;
      padding: 0 $spacing * 2.5;
      font-weight: 500;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: $spacing;
      background: rgba(255, 255, 255, 0.9);
      border-color: rgba($primary-color, 0.25);
      color: $primary-color;

      mat-icon {
        font-size: 20px;
        width: 20px;
        height: 20px;
      }

      &:hover {
        background: rgba($primary-color, 0.06);
        border-color: rgba($primary-color, 0.55);
        box-shadow: 0 4px 12px rgba(25, 118, 210, 0.18);
      }
    }
  }

  .card-content {
    padding: $spacing * 3;
  }
}

// ===============================
//  FORM SECTIONS
// ===============================

.form-section {
  margin-bottom: $spacing * 3;
  padding: $spacing * 2.5 $spacing * 2.5;
  border-radius: $radius-md;
  background: rgba(255, 255, 255, 0.82);
  border: 1px solid rgba(148, 163, 184, 0.18);
  box-shadow: 0 10px 28px rgba(15, 23, 42, 0.10);
  animation: fadeInSection 0.45s ease-out;
  animation-fill-mode: both;

  .section-header {
    margin-bottom: $spacing * 2;

    .section-title-wrapper {
      display: flex;
      align-items: center;
      gap: $spacing * 1.5;
      margin-bottom: $spacing * 1.25;

      .section-icon {
        color: $primary-color;
        font-size: 22px;
        width: 22px;
        height: 22px;
      }

      .section-title {
        font-size: 17px;
        font-weight: 600;
        color: $text-primary;
        margin: 0;
      }
    }

    mat-divider {
      border-top-color: rgba(148, 163, 184, 0.4);
    }
  }
}

// Staggered animation: each section little delay
.form-section:nth-of-type(1) { animation-delay: 0.05s; }
.form-section:nth-of-type(2) { animation-delay: 0.09s; }
.form-section:nth-of-type(3) { animation-delay: 0.13s; }
.form-section:nth-of-type(4) { animation-delay: 0.17s; }
.form-section:nth-of-type(5) { animation-delay: 0.21s; }

// ===============================
//  GRID LAYOUT
// ===============================

.form-grid {
  display: grid;
  gap: $spacing * 2;

  &.grid-2 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  &.grid-3 {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  &.grid-4 {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }
}

// Responsive breakpoints
@media (max-width: 1200px) {
  .form-grid.grid-4 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (max-width: 960px) {
  .form-grid.grid-3,
  .form-grid.grid-4 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (max-width: 768px) {
  :host {
    padding: $spacing * 2;
  }

  .form-card.glass-card .card-header {
    flex-direction: column;
    align-items: flex-start;
    gap: $spacing * 1.5;

    .go-list-btn {
      align-self: flex-end;
    }
  }

  .form-grid.grid-2,
  .form-grid.grid-3,
  .form-grid.grid-4 {
    grid-template-columns: 1fr;
  }

  .form-section {
    padding: $spacing * 2;
  }
}

// ===============================
//  FORM FIELDS â€“ GLASS STYLE
// ===============================

.form-field {
  // Label tweaks
  mat-label {
    font-weight: 500;
    color: $text-secondary;
  }

  .field-icon {
    color: rgba(100, 116, 139, 0.95);
  }

  // --- OVERRIDES for Material Outlined fields ---
  // Remove default double-outline & underline
  ::ng-deep .mdc-line-ripple {
    display: none !important;
  }

  ::ng-deep .mdc-notched-outline__leading,
  ::ng-deep .mdc-notched-outline__notch,
  ::ng-deep .mdc-notched-outline__trailing {
    border: none !important;
  }

  // Glass wrapper
  ::ng-deep .mat-mdc-text-field-wrapper {
    @include transition-all(0.18s);
    background: rgba(255, 255, 255, 0.65) !important;
    backdrop-filter: blur(16px) saturate(1.2);
    -webkit-backdrop-filter: blur(16px) saturate(1.2);
    border-radius: 14px !important;
    border: 1px solid rgba(148, 163, 184, 0.45) !important;
    box-shadow: 0 6px 20px rgba(15, 23, 42, 0.08);

    .mat-mdc-form-field-flex {
      padding-inline: $spacing * 1.25;
    }
  }

  // Remove overlay color on focus
  ::ng-deep .mat-mdc-form-field-focus-overlay {
    background-color: transparent !important;
  }

  // Text
  ::ng-deep .mat-mdc-input-element {
    color: $text-primary;
    font-size: 14px;
  }

  // Placeholder / hint tone
  ::ng-deep .mat-mdc-form-field-subscript-wrapper {
    margin-top: $spacing * 0.75;
  }

  // On focus
  &.mat-focused {
    ::ng-deep .mat-mdc-text-field-wrapper {
      border-color: rgba($primary-color, 0.85) !important;
      box-shadow: 0 0 0 1px rgba($primary-color, 0.25),
        0 10px 30px rgba(25, 118, 210, 0.25);
    }

    mat-label {
      color: $primary-color;
    }

    .field-icon {
      color: $primary-color;
    }
  }

  // Error state
  &.mat-form-field-invalid {
    ::ng-deep .mat-mdc-text-field-wrapper {
      border-color: rgba($warn-color, 0.9) !important;
      box-shadow: 0 0 0 1px rgba($warn-color, 0.25),
        0 8px 24px rgba(244, 67, 54, 0.35);
    }

    mat-label {
      color: $warn-color;
    }
  }

  // mat-error styling
  ::ng-deep .mat-mdc-form-field-error {
    font-size: 12px;
    color: $warn-color !important;
  }
}

// ===============================
//  DATEPICKER & SELECT TWEAKS
// ===============================

::ng-deep .mat-datepicker-toggle-default-icon,
::ng-deep .mat-mdc-select-arrow {
  color: rgba(100, 116, 139, 0.9);
}

::ng-deep .mat-mdc-select-panel {
  border-radius: $radius-md;
  box-shadow: 0 16px 35px rgba(15, 23, 42, 0.28);
}

::ng-deep .mat-mdc-option {
  font-size: 14px;

  &:hover {
    background: rgba($primary-color, 0.08);
  }

  &.mat-mdc-option-active {
    background: rgba($primary-color, 0.12);
    color: $primary-dark;
    font-weight: 500;
  }
}

// ===============================
//  CHECKBOXES
// ===============================

.checkbox-field {
  display: flex;
  align-items: center;
  padding: $spacing * 1.5 0;

  .custom-checkbox {
    ::ng-deep .mdc-form-field {
      color: $text-primary;
      font-weight: 500;
    }

    ::ng-deep .mdc-checkbox__background {
      border-radius: 6px;
      border-color: rgba(148, 163, 184, 0.9);
    }

    ::ng-deep .mat-mdc-checkbox-checked .mdc-checkbox__background,
    ::ng-deep .mat-mdc-checkbox-indeterminate .mdc-checkbox__background {
      background-color: $primary-color;
      border-color: $primary-color;
      box-shadow: 0 6px 18px rgba(25, 118, 210, 0.45);
    }
  }
}

// ===============================
//  FORM ACTION BUTTONS
// ===============================

.form-actions {
  margin-top: $spacing * 3;
  padding-top: $spacing * 2.5;
  border-top: 1px solid rgba(148, 163, 184, 0.3);
  display: flex;
  justify-content: flex-end;
  gap: $spacing * 2;

  button {
    height: 44px;
    border-radius: $radius-sm;
    font-weight: 500;
    font-size: 14px;
    padding-inline: $spacing * 2.5;
    @include transition-all(0.18s);

    mat-icon {
      font-size: 20px;
      margin-right: $spacing;
    }
  }

  .btn-secondary {
    border: 1px solid rgba(148, 163, 184, 0.7);
    color: $text-secondary;
    background: rgba(255, 255, 255, 0.9);

    &:hover {
      background: rgba(148, 163, 184, 0.08);
      border-color: rgba(148, 163, 184, 1);
      box-shadow: 0 6px 18px rgba(148, 163, 184, 0.45);
    }
  }

  .btn-primary {
    background: linear-gradient(135deg, $primary-color, $primary-light);
    color: #fff;
    box-shadow: 0 10px 28px rgba(25, 118, 210, 0.35);

    &:hover {
      background: linear-gradient(135deg, $primary-dark, $primary-color);
      box-shadow: 0 14px 36px rgba(25, 118, 210, 0.45);
      transform: translateY(-1px);
    }

    &:active {
      transform: translateY(0);
      box-shadow: 0 8px 22px rgba(25, 118, 210, 0.35);
    }
  }
}

@media (max-width: 600px) {
  .form-actions {
    flex-direction: column-reverse;
    align-items: stretch;

    button {
      width: 100%;
      justify-content: center;
    }
  }
}

// ===============================
//  ANIMATIONS
// ===============================

@keyframes fadeInCard {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.99);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes fadeInSection {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
